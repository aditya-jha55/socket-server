"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.lambdaCommand = void 0;
const log_1 = require("./log");
const get_package_manager_1 = require("./preview-server/get-package-manager");
const update_available_1 = require("./preview-server/update-available");
const lambdaCommand = async (remotionRoot, args) => {
    try {
        const path = require.resolve('@remotion/lambda', {
            paths: [remotionRoot],
        });
        const { LambdaInternals } = require(path);
        await LambdaInternals.executeCommand(args, remotionRoot);
        process.exit(0);
    }
    catch (err) {
        const manager = (0, get_package_manager_1.getPackageManager)(remotionRoot, undefined);
        const installCommand = manager === 'unknown' ? 'npm i' : manager.installCommand;
        log_1.Log.error(err);
        log_1.Log.error('Remotion Lambda is not installed.');
        log_1.Log.info('');
        log_1.Log.info('You can install it using:');
        log_1.Log.info(`${installCommand} @remotion/lambda@${(0, update_available_1.getRemotionVersion)()}`);
        process.exit(1);
    }
};
exports.lambdaCommand = lambdaCommand;
